# 유비쿼터스 언어

| 용어           | 정의                                 |
|--------------|------------------------------------|
| 유저 (User)    | 서비스를 이용하고 주문, 결제, 포인트 충전, 좋아요의 주체  |
| 상품 (Product) | 유저가 결제할 수 있는 서비스 상의 상품             |
| 재고 (Stock)   | 상품에 대한 남은 수량                       |
| 브랜드 (Brand)  | 상품을 보유하고 있는 브랜드                    |
| 포인트 (Point)  | 유저가 충전하거나 이후 결제 시 현금처럼 사용할 수 있는 단위 |
 | 좋아요 (Like)   | 유저가 특정 상품에 대한 좋은지를 표현하는 행위         |
| 주문 (Order)   | 유저가 상품을 구매하기 위해 생선된 요청             |
| 결제 (Payment) | 주문에 대한 금전적 거래                      |

# 요구사항 정리

- 유저 (유저)
  - 시나리오
    - 유저는 내 정보를 조회할 수 있다.
  - 흐름
    1. 로그인 사용자만 가능
    2. 유저 정보 있는지 없는지 판단
    3. 있으면 유저 정보 반환, 없으면 오류 
    4. 유저 정보 보여짐, 없으면 404 Not Found

- 브랜드 & 상품 (유저, 비유저)
  - 시나리오
    - 모두 브랜드 정보를 조회할 수 있다.
  - 흐름
    1. 모두 브랜드 정보 조회 가능
    2. 브랜드가 있는지 없는지 판단
    3. 있으면 브랜드 정보 반환, 없으면 오류
    4. 브랜드 정보 보여짐, 없으면 404 Not Found
  - 시나리오
    - 모두 상품 목록을 조회할 수 있다.
  - 흐름
    1. 모두 조회 가능 sort, page, size를 선택 가능
    2. 상품 목록이 있는지 판단
    3. 있으면 상품 목록울 반환, 없으면 오류
    4. 상품 목록 보여짐, 없으면 404 Not Found
  - 시나리오
    - 모두 상품 상세 정보를 조회할 수 있다.
  - 흐름
    1. 모두 상품 정보 조회 가능
    2. 상품이 있는지 없는지 판단
    3. 있으면 상품 상세 정보 반환, 없으면 오류
    4. 상품 정보 보여짐, 없으면 404 Not Found

- 포인트 (유저)
  - 시나리오
    - 유저는 포인트를 충전할 수 있다.
  - 흐름
    1. 로그인 사용자만 가능
    2. 유저가 있는지 없는지 판단
    3. 유저 있으면 포인트 충전, 없으면 오류
    4. 유저 있으면 충전 후 포인트 보여짐, 없으면 404 Not Found
  - 시나리오
    - 유저는 보유 포인트를 조회할 수 있다.
  - 흐름
    1. 로그인 사용자만 가능
    2. 유저가 있는지 없는지 판단
    3. 유저 있으면 포인트 조회, 없으면 오류
    4. 유저 있으면 보유 포인트 보여짐, 없으면 404 Not Found
  
- 좋아요 (유저)
  - 시나리오
    - 유저는 상품을 좋아요 할 수 있다.
  - 흐름
    1. 로그인 사용자만 가능
    2. 유저가 있는지 없는지 판단
    3. 유저 있으면 좋아요 존재하는지 판단, 유저 없으면 오류
    4. 좋아요가 이미 있어도 Success, 없으면 좋아요 등록
       - 좋아요 테이블 설계시 productId, userId에 복합 PK를 걸고 INSERT시 MySQL 기준 INSERT IGNORE를 사용하여 멱등성 처리
    5. 유저가 있고 좋아요를 새로 등록하거나 이미 존재하면 성공, 유저가 없으면 404 Not Found
  - 시나리오
    - 유저는 상품의 좋아요를 취소할 수 있다.
  - 흐름
    1. 로그인 사용자만 가능
    2. 유저가 있는지 없는지 판단
    3. 유저 있으면 좋아요 존재하는지 판단, 유저 없으면 오류
    4. 좋아요가 이미 존재하면 삭제 처리, 없어도 Success
    5. 유저가 있고 좋아요를 새로 삭제하거나 이미 삭제했어도 성공, 유저가 없으면 404 Not Found
  - 시나리오
    - 유저는 내가 좋아요 한 상품 목록을 조회할 수 있다.
  - 흐름
    1. 로그인 사용자만 가능
    2. 유저가 있는지 없는지 판단
    3. 유저 있으면 좋아요한 상품 목록 조회, 없으면 오류
    4. 좋아요한 상품 목록 있으면 상품 목록 보여짐, 없으면 404 Not Found

- 주문 & 결제 (유저)
  - 시나리오
    - 유저는 상품을 주문하고 결제를 할 수 있다.
  - 흐름
    1. 로그인 사용자만 가능
    2. 유저, 상품이 있는지 판단
    3. 유저, 상품 있으면 재고 감소 예약(감소 예약시 0 미만이면 400 Bad Request), 없으면 오류(404 Not Found)
    4. 주문 대기중으로 생성
    5. 결제 대기중으로 생성
    6. 주문 대기중인 정보 응답
    7. 추후 결제창 후 결제 완료 시 재고 실행, 포인트 차감(포인트 차감시 0 미만이면 400 Bad Request) 결제 완료 처리, 결제완료 없이 그냥 종료면 배치나 crontab으로 주문 자동 취소 처리
    8. 결제 완료된 주문 정보 응답, 없으면 404 Not Found
  - 시나리오
    - 유저는 주문 목록을 조회 할 수 있다.
  - 흐름
    1. 로그인 사용자만 가능
    2. 유저가 있는지 없는지 판단
    3. 유저 있으면 주문 목록 조회, 없으면 오류
    4. 주문 목록 보여짐, 없으면 404 Not Found
  - 시나리오
    - 유저는 단일 주문 상세 조회를 할 수 있다.
  - 흐름
    1. 로그인 사용자만 가능
    2. 유저가 있는지 없는지 판단
    3. 유저 있으면 주문 상세 조회, 주문 없으면 오류
    4. 주문 상세 보여짐, 없으면 404 Not Found
